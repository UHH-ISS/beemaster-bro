version: '2'
# This Composefile uses named volumes for simplicity. The actual data is saved to /var/lib/docker/volumes/$VOLUME/_data.
# Build args are passed to the Dockerfile to determine the container's purpose.

volumes:
  master-logs:
  slave-1-logs:
  slave-2-logs:
  slave-3-logs:

services:
  bro-master:
    build: 
      context: ./mp-ids-bro
      args:
        PURPOSE: master
    command: ["/bro/scripts_master/"]
    volumes:
      - master-logs:/usr/local/bro/logs

  bro-slave-1:
    build: 
      context: ./mp-ids-bro
      args:
        PURPOSE: slave
    command: ["/bro/scripts_slave/"]
    volumes:
      - slave-1-logs:/usr/local/bro/logs
    depends_on:
      - bro-master

  bro-slave-2:
    build:
      context: ./mp-ids-bro
      args:
        PURPOSE: slave
    command: ["/bro/scripts_slave/"]
    volumes:
      - slave-2-logs:/usr/local/bro/logs
    depends_on:
      - bro-master

networks:
  beemaster-demo:
    driver: overlay